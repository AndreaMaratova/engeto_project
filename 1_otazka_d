-- Průměr růstu mezd celé republiky v letech 
SELECT 
    a.year,
    a.prumerna_mzda_vsechny_obory,
    ROUND(((a.prumerna_mzda_vsechny_obory - b.prumerna_mzda_vsechny_obory_1) / b.prumerna_mzda_vsechny_obory_1) * 100, 2) AS pct_zmena
FROM 
    (SELECT 
         year, 
         AVG(prumerna_mzda) AS prumerna_mzda_vsechny_obory
     FROM t_andrea_maratova_project_sql_primary_final 
     GROUP BY year) a
LEFT JOIN 
    (SELECT 
         year, 
         AVG(prumerna_mzda) AS prumerna_mzda_vsechny_obory_1
     FROM t_andrea_maratova_project_sql_primary_final
     GROUP BY year) b 
ON a.year = b.year+ 1
ORDER BY YEAR asc;
