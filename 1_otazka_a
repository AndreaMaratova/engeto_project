-- pouze roky 2006 a 2018, seřazení dle nejvyšší procentuální změny
SELECT 
	a.industry_name, 
	a.prumerna_mzda AS prumerna_mzda_2006,
	b.prumerna_mzda AS prumerna_mzda_2018, 
	round(((b.prumerna_mzda - a.prumerna_mzda)/a.prumerna_mzda)*100,2) AS procentualni_zmena,
	b.prumerna_mzda-a.prumerna_mzda AS realny_rust,
	CASE 
		WHEN lag(a.prumerna_mzda) OVER (PARTITION BY a.industry_name ORDER BY a.YEAR) > a.prumerna_mzda THEN 'NE' ELSE 'ANO'
	END AS vyssi_mzda
FROM t_andrea_maratova_project_sql_primary_final a
JOIN t_andrea_maratova_project_sql_primary_final b
ON a.industry_branch_code = b.industry_branch_code 
	AND a.YEAR = 2006
	AND b.`YEAR` = 2018
GROUP BY a.industry_name 
ORDER BY procentualni_zmena desc;
